Code for model and training
